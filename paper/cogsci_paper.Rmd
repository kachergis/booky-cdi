---
title: "Identifying the distributional sources of children's early vocabulary"
bibliography: library.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
    \author{{\large \bf George Kachergis* (kachergis@stanford.edu)} \\ Department of Psychology, Stanford University \\ Stanford, CA 94305 USA
    \AND {\large \bf Georgia Loukatou* (@stanford.edu)} \\ Department of Psychology, Stanford University \\ Stanford, CA 94305 USA
    \AND {\large \bf Michael C. Frank (mcfrank@stanford.edu)} \\ Department of Psychology, Stanford University \\ Stanford, CA 94305 USA}

abstract: >
    Children's early word learning is to a large extent driven by the prevalence of
    words in their language environment, with words that are spoken more often to children
    being learned earlier. However, children receive language from a variety of sources, 
    including books, television, and movies meant for children, as well as speech and media
    that is meant for adults, but overheard by children. Despite considerable similarity
    of word frequency distributions from these different input sources, there is also significant
    and predictable variability between them. For example, function words are far more frequent
    in books than in everyday speech, while early-learned nouns (e.g., 'ball' and 'mommy') are 
    more frequent in child-directed speech than from other sources. Children receive a mixture 
    of these different frequency distributions. The goal of this paper is to better understand
    the shared and unique variance in these sources of input--in both English and French--and 
    to evaluate how predictive these input frequencies are of children's early word learning.
    
keywords: >
    early language learning; CDI; vocabulary development; word frequency distributions.
    
output: cogsci2016::cogsci_paper
#final-submission: \cogscifinalcopy
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, 
                      fig.pos = "tb", fig.path='figs/',
                      echo=F, warning=F, cache=F, 
                      message=F, sanitize = T)
```

```{r, libraries}
library(png)
library(grid)
library(ggplot2)
library(xtable)
library(here)
library(glue)
library(wordbankr)
require(tidyverse)
require(here)
require(ggrepel)
require(kableExtra)
require(tidyboot)
require(readr)
require(tokenizers)
require(lme4)
require(lmerTest)
require(ggeffects)
require(ggpubr)
require(tidytext)
require(GGally)
library(corrplot)
library(coefplot)
require(boot)
```

# Introduction

How does speech addressed to children, heard on television, or read in books impact the growth of children's early vocabulary? 
How does speech from these sources relate to adult-directed sources of speech? 
And how do these potential language sources combine with parental education to predict young children's vocabulary growth? 
Children must learn words based on ambient linguistic input, and indeed the amount of child-directed speech a child receives predicts later vocabulary growth [@hart1995meaningful].
However, children's exposure to different words can vary greatly depending on the source -- spoken language vs. books vs. media -- and the register -- child-directed vs. adult directed -- of the language. 
<!-- These different inputs can vary both in quantity, as well as in various measures of quality (e.g., diversity of the types of words used, the length of utterances), which may influence children's uptake. -->
Moreover, the amount of input children receive from these different input sources may vary from child to child, which may account for some of the great variability seen in children's early vocabulary growth [cf. @fenson1994variability].
Indeed, higher measures of input quantity and quality have been found to relate to children's faster vocabulary growth, and to often be related to parents' socioeconomic status [SES; @rowe2012longitudinal; @hoff2003specificity]. 
<!-- @rowe2018understanding; Importantly, this variance has been found to relate to children's language development and to be predictive of aspects of word learning [@hoff2003specificity]. -->

Input word frequency varies significantly depending on the context. 
Previous studies have shown that frequency matters for children's word learning [for a review, see @ambridge2015ubiquity], and have observed an association between word frequency in children's language environments and age of acquisition [@goodman2008]. 
For instance, word frequency in books is not the same as frequency in conversational speech, with many function words being far more frequent in books than in speech [@dawson2021features; @montag2015words]. 

Some differences between frequency distributions are intuitive: "mommy" is quite frequent in child-directed speech, yet not so common in children's books, and even more rare in books meant for all ages. But other differences are less intuitive: "of" is frequent in books meant for all ages, and while still frequent in child-directed speech, it is relatively less frequent as compared to children's books. In general, speech -- whether directed to children or to adults -- contains relatively fewer function words and tends to score lower on measures of lexical diversity than books, which have a higher ratio of types (unique words) per set of tokens [instances of words; @dawson2021features].

In this paper, we have three goals. First, we examine shared and unique variance in word frequency across different sources of English and French input, ranging from children's books and movies to child-directed speech and even comparing to adult-directed books, movies, and speech. Because of the substantial correlations between these different input sources, we employ principal components analysis (PCA) for dimensionality reduction. 

Second, we investigate how well these components predict English- and French-learning children's early word learning, using aggregate MacArthur-Bates Communicative Development Inventories (CDI) data from Wordbank [@frank2017wordbank]. CDIs are parent report forms for children's early vocabulary, and they have proven to be reliable and valid indicators of child's language [@fenson1994variability]. Critically, CDI forms provide details about the individual words that children produce. These data allow us to investigate the role of different frequency sources using the Age of Acquisition (AoA) prediction paradigm, in which we use regression models to predict each CDI item's mean Age of Acquisition (AoA) -- the mean age (in months) at which 50% of children are expected to know a given word [@braginsky2019consistency; @goodman2008]. 

<!-- We expect less contribution to word learning from adult-directed speech, movies and books, because of other factors relevant to quality: for example, adult-directed sources may include longer length of utterances, more lexical diversity and less interaction compared with child-directed speech, movies and books [@rowe2012longitudinal]. Factors may also relate to quantity; children may simply receive less language from adult-directed sources. -->

Third, we examine how well different input sources predict SES differences in  word learning for English-learning children. We index SES using maternal education, a common proxy measure. Young children from higher-SES households tend to have larger vocabulary [@fernald2013ses] and parents with higher-SES tend to report reading more to their young children than parents with lower SES. 

<!-- Can vocabulary composition of children from higher-SES households be better predicted by book word frequency? -->

<!-- The questions investigated in this paper aim to shed light on the importance of input sources on language development and its interaction with parental SES, would can be useful for informing future interventions. -->


# Method

## Datasets

```{r load-data}
load("../data/merged_word_freqs.Rdata")
load("../data/merged_word_freqs_fr.Rdata") 
# ToDo: try smoothing with +1 or dropping missing words, save new versions and re-run

aoas <- readRDS("../data/english_(american)_aoa_bydefinition.rds") %>%
  filter(measure=="produces")

load("../data/Charlesworth-unlemmatized-counts.Rdata") 

total_child_tokens <- child_dat %>% group_by(source) %>%
    summarise(word_count = sum(word_count),
              n = n())

total_adult_tokens <- adult_dat %>% group_by(source) %>%
    summarise(word_count = sum(word_count),
              n = n())
              
# TODO: these word_counts are already normalized -- we want raw counts!
total_child_tokens_fr <- ch_freq_fr %>% 
  select(-adult_speech, -adult_tv, -adult_book) %>%
  pivot_longer(c(child_speech,  child_book, child_tv), names_to = "source", values_to = "word_count") %>%
    filter(!is.na(word_count)) %>%
    group_by(source) %>%
    summarise(word_count = sum(word_count, na.rm=TRUE),
              n = n())

# TODO: these word_counts are already normalized -- we want raw counts!
total_adult_tokens_fr <- ch_freq_fr %>% 
  select(-child_speech, -child_tv, -child_book) %>%
  pivot_longer(c(adult_speech,  adult_book, adult_tv), names_to = "source", values_to = "word_count") %>%
    filter(!is.na(word_count)) %>%
    group_by(source) %>%
    summarise(word_count = sum(word_count, na.rm=TRUE),
              n = n())
```


Corpora from different sources are used to identify shared and distinct variance in frequencies. These corpora vary widely in size due to data accessibility; several were created for the current study and are available in our GitHub repository.

### Child-directed Speech (ChS).
Utterances of ChS were extracted from the CHILDES corpus [@macwhinney2000childes], a collection of transcripts of interactions between caregivers and children of ages ranging from 0 to 12 years ($M=2.9$ years). After cleaning, the CHILDES English corpus yielded `r format(round(subset(total_child_tokens, source=="speech")$word_count, -3), scientific=F)` tokens across `r format(subset(total_child_tokens, source=="speech")$n, scientific=F)` word types. The French ChS yielded `r format(round(subset(total_child_tokens_fr, source=="child_speech")$word_count, -3), scientific=F)` tokens across `r format(subset(total_child_tokens_fr, source=="child_speech")$n, scientific=F)` word types.

### Child-directed books (ChB).
We used a sample of 98 English children's books from Project Gutenberg's open-source database, previously used in machine learning research on language comprehension [@hill2015goldilocks]. The books were published between 1820 and 1922, but include well-known titles as *The Legend of Sleepy Hollow*. We also used 130 popular French children stories accessible in parenting websites (https://fr.hellokids.com/) and 10 French children books from Project Gutenberg. After cleaning, the English ChB corpus totals `r format(round(subset(total_child_tokens, source=="books")$word_count, -3), scientific=F)` tokens across `r format(subset(total_child_tokens, source=="books")$n, scientific=F)` word types, and the French ChB totals `r format(round(subset(total_child_tokens_fr, source=="child_book")$word_count, -3), scientific=F)` tokens across `r format(subset(total_child_tokens_fr, source=="child_book")$n, scientific=F)` word types.

### Child-directed Media (ChM).
Transcripts were extracted from English television shows (e.g., from PBS Kids and Nickelodeon) and movies (e.g., *Beauty and the Beast*), including 1,078 movies and 4,309 TV episodes taken from @charlesworth2021gender (available here: [https://osf.io/kqux5/](https://osf.io/kqux5/). Openly accessible transcripts (https://www.subsynchro.com/) were also extracted from 100 French films directed to children. After cleaning, the English ChM totals `r format(subset(total_child_tokens, source=="tv")$word_count, scientific=F)` tokens across `r format(subset(total_child_tokens, source=="tv")$n, scientific=F)` word types.  The French ChM totals `r format(round(subset(total_child_tokens_fr, source=="child_tv")$word_count, -3), scientific=F)` tokens across `r format(subset(total_child_tokens_fr, source=="child_tv")$n, scientific=F)` word types. 

### Adult-directed Speech (AdS).
English AdS was obtained from the Switchboard-1 Telephone Speech Corpus (Godfrey & Holliman, 1993), a corpus of transcripts from dyadic telephone conversations. French AdS was obtained from the TCOF corpus [@andre2010mise], the CLAPI corpus [@balthasar2005plateforme] and the CFPP corpus [@branca2012discours]. After cleaning, the English AdS yielded `r format(round(subset(total_adult_tokens, source=="speech")$word_count, -3), scientific=F)` tokens across `r format(subset(total_adult_tokens, source=="speech")$n, scientific=F)` word types. The French AdS yielded `r format(round( subset(total_adult_tokens_fr, source=="adult_speech")$word_count, -3), scientific=F)` tokens across `r format(subset(total_adult_tokens_fr, source=="adult_speech")$n, scientific=F)` word types.

### Adult-directed Books (AdB).
The English AdB is comprised of `r format(round(subset(total_adult_tokens, source=="books")$word_count, -3), scientific=F)` tokens across `r format(subset(total_adult_tokens, source=="books")$n, scientific=F)` word types. The French AdB is comprised of books taken from the 1999 Association de Bibliophiles Universels, an open-source database of french books. After cleaning, it yielded `r format(round(subset(total_adult_tokens_fr, source=="adult_book")$word_count, -3), scientific=F)` tokens across `r format(subset(total_adult_tokens_fr, source=="adult_book")$n, scientific=F)` word types.


### Adult-directed Media (AdM).
The English AdM is comprised of `r format(round(subset(total_adult_tokens, source=="TV")$word_count, -3), scientific=F)` tokens across `r format(subset(total_adult_tokens, source=="TV")$n, scientific=F)` word types. The French AdM corpus is comprised of `r format(round(subset(total_adult_tokens_fr, source=="adult_tv")$word_count, -3), scientific=F)` tokens across `r format(subset(total_adult_tokens_fr, source=="adult_tv")$n, scientific=F)` word types, after cleaning openly accessible movie subtitles (https://www.subsynchro.com/) from 100 films.

### Age of Acquisition data

Children's early word learning data is drawn from the CDIs [@fenson2007], aggregated in the Wordbank database [@frank2017wordbank] (data from 5520 children aged 16-30 months for the American English CDI: Words & Sentences (WS) form, and 641 children for the French French CDI:WS form). Age of acquisition estimates were calculated via the wordbankr package using the XYZ method. 
<!-- FIXME -->


## Merging the Corpora

```{r}
#load("../data/Charlesworth-unlemmatized-counts.Rdata") 
# Montag corpus
dd <- ch_freq_smooth %>% filter(on_cdi==1) %>% 
  select(-ch_book_vs_speech) 

# Charlesworth (FB children's books)
dd_novels <- ch_freq_smooth_charles %>% filter(on_cdi==1) %>% 
  select(-ch_book_vs_speech) 

ddd <- dd %>% select(-prop_booky) %>%
  left_join(dd_novels %>% select(-prop_booky)) %>%
  mutate(Nletters = ifelse(is.na(Nletters), nchar(word), Nletters)) %>%
  left_join(aoas %>% select(-measure))

dddc <- ddd %>% mutate(adult_books = ifelse(is.na(adult_books), 0.07322, adult_books),
                       speech = ifelse(is.na(speech), 10, speech),
                       books = ifelse(is.na(books), 10, books),
                       tv = ifelse(is.na(tv), 10, tv)) %>%
  distinct()

adult_dat <- adult_dat %>% filter(source!="books") %>%
  select(source, word, word_count_norm) %>%
  pivot_wider(id_col = word, names_from = source, values_from = word_count_norm) %>%
  rename(`AdS` = speech,
         `AdM` = TV)

dddc <- dddc %>% 
  rename(`AdB` = adult_books, # Google books
         `ChB` = books, # Facebooks children's books (novels..)
         `ChM` = tv,
         `ChS` = speech) %>% 
  select(-CHILDES) %>% # less well-cleaned version
  left_join(adult_dat)

# use the minimum normalized count values for these (large) corpora 
dddc <- dddc %>% replace_na(list(`AdS` = 0.32,
                                 `AdM` = 0.33)) 


dd_fr <- ch_freq_smooth_fr %>% filter(on_cdi==1) %>% 
  select(-ch_book_vs_speech, -prop_booky) %>%
  mutate(Nletters = nchar(token)) %>%
  group_by(definition, lexical_class) %>% # group to have 1 row per CDI item: 
  summarize(adult_book = sum(adult_book, na.rm=T),
            adult_speech = sum(adult_speech, na.rm=T),
            child_book = sum(child_book, na.rm=T),
            adult_tv = sum(adult_tv, na.rm=T),
            child_tv = sum(child_tv, na.rm=T),
            child_speech = sum(child_speech, na.rm=T),
            Nletters = mean(Nletters, na.rm=T),
            aoa = mean(aoa, na.rm=T)) %>% # sum the counts, average the aoas and Nletters
  mutate(adult_book = ifelse(is.na(adult_book) | adult_book==0, 10, adult_book),
         adult_speech = ifelse(is.na(adult_speech) | adult_speech==0, 10, adult_speech),
         child_book = ifelse(is.na(child_book) | child_book==0, 10, child_book),
         adult_tv = ifelse(is.na(adult_tv) | adult_tv==0, 10, adult_tv),
         child_tv = ifelse(is.na(child_tv) | child_tv==0, 10, child_tv),
         child_speech = ifelse(is.na(child_speech) | child_speech==0, 10, child_speech)) %>%
         distinct()

dddc_fr <- dd_fr %>% 
  rename(`AdB` = adult_book,  
         `ChB` = child_book, 
         `AdM` = adult_tv,
         `AdS` = adult_speech,
         `ChS` = child_speech,
         `ChM` = child_tv)

```


We focus our analysis on the `r length(unique(dddc$definition))` words from the English CDI that we were able to identify in at least some of the corpora, and `r length(unique(dddc_fr$definition))` words from the French CDI. For French, because of the presence of more complex morphology, CDI words were matched to related words in corpora via a stemmer. 
For any CDI words that failed to appear in a given corpus, we replaced the missing word's frequency with a normalized count of 10 TPM, or the minimum normalized frequency for that distribution, whichever was smaller.
All word frequencies were normalized to number of tokens per million (TPM). 

# Results

## Cross-corpus Frequency Correlations (Q1)


```{r fig1, out.width="\\linewidth", fig.env = "figure", fig.pos = "t", fig.align='center', fig.width=3.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Word frequency correlations between different corpus sources for the matched CDI words in English (left) and French (right)."}
res_en=cor(dddc[,c("ChS","ChM","ChB","AdS","AdM","AdB")])
res_fr=cor(dddc_fr[,c("ChS","ChM","ChB","AdS","AdM","AdB")])

# save figures
generate_fig1 <- function() {
pdf("figs/en_freq_cor.pdf", width=3.1, height=3.1)
corrplot(res_en, type="upper", method="circle", bg="snow", number.cex = .8, tl.cex=.9, diag=F, #col=corcol,
              addCoef.col = "white", number.digits = 2, tl.col="black", tl.srt=20, cl.pos="n")
dev.off()

pdf("figs/fr_freq_cor.pdf", width=3.1, height=3.1)
corrplot(res_fr, type="upper", method="circle", bg="snow", number.cex = .8, tl.cex=.9, diag=F, #col=corcol,
              addCoef.col = "white", number.digits = 2, tl.col="black", tl.srt=20, cl.pos="n") 
dev.off()
}

#generate_fig1()

#knitr::include_graphics("figs/corpus_freq_cors_vert.pdf", dpi=144)
knitr::include_graphics("figs/corpus_freq_cors_hor.pdf")
```


```{r freq-distro-cor-tables, include=F}
cor(dddc[,c("ChS","ChM","ChB","AdS","AdM","AdB")]) %>%
    papaja::apa_table(digits=2, placement='h',
                      caption="Correlations in word frequency between different sources for CDI words (English)")

cor(dddc_fr[,c("ChS","ChM","ChB","AdS","AdM","AdB")]) %>%
    papaja::apa_table(digits=2, placement='h',
                      caption="Correlations in word frequency between different sources for CDI words (French).")
```

```{r pca}
pc_bsa <- prcomp(log(dddc[,c("ChM","ChB","ChS",
                             "AdM","AdB","AdS")])) # add Montag separately?
eigenvalues_en = pc_bsa$sdev^2 # only first 2 PCs have eigenvalues >1

pc_bsa_fr <- prcomp(log(dddc_fr[,c("ChM","ChB","ChS",
                             "AdM","AdB","AdS")])) 
eigenvalues_fr = pc_bsa_fr$sdev^2 # only first 2 PCs have eigenvalues >1

pc_imp_en <- summary(pc_bsa)$importance
pc_imp_fr <- summary(pc_bsa_fr)$importance 
var4en = sum(pc_imp_en[2,1:4]) # 
var4fr = sum(pc_imp_fr[2,1:4]) # 93
```

Figure 1 shows the word frequency correlations between different corpus sources ([Adult- vs. Child-directed] x [Speech, Books, Media]) for the matched CDI words (left: English, right: French). Unsurprisingly, there were strong correlations across these different corpora, but correlations were stronger within register and within source for both English and French. 

We thus turned to PCA to disentangle these correlated distributions and to understand their relationship. PCA allows us to project word frequencies into a space in which the first dimension captures the shared variance between frequencies from different sources and registers, and subsequent dimensions capture other consistent sources of variation. Since the logarithm of frequency is typically used as a psycholinguistic predictor in previous studies [@braginsky2019consistency; @goodman2008], we perform our PCA over log frequencies.

Table 1 provides descriptions of the principal components (PC1-PC6) for each language. Table 2 summarizes the eigenvectors of the PCs in relation to the original six frequency distributions for English and French, and shows the proportion of variance explained by each. PC1 already explains the bulk of the variance (`r round(pc_imp_en[2,1],3)*100`% for English and `r round(pc_imp_fr[2,1],3)*100`% for French); and PC2-PC4 each only capture an additional 2-4% of the variance for both languages.

The first PC is similar for both English and French, and captures shared variance between all frequency sources and registers, representing words that are high or low frequency across them. This means that frequency distributions are largely similar across sources and registers. The second PC for English mostly captures child-directed speech, differentiating it from ll the other registers, whereas for French it captures book language, differentiating it from speech. PC2 explains `r round(pc_imp_en[2,2],3)*100`% of variance for English and `r round(pc_imp_fr[2,2],3)*100`% of variance for French. Adult-directed speech is captured in English as the third PC (`r round(pc_imp_en[2,3],3)*100`% of variance), whereas the difference between child-directed and adult-directed speech is captured in French as the third PC (`r round(pc_imp_fr[2,3],3)*100`% of variance). The additional PCs capture differences between media and book or speech, as well as differences between media registers (child-directed vs adult-directed) for both languages. 

In summary, the PCs align surprisingly well with particular dimensions of the English frequency distributions: PC1 with overall frequency, PC2 with child-directed speech, PC3 with adult-directed speech, PC4 with media vs. books, PC5 with child-directed books vs. speech, and PC6 with adult- vs. child-directed media.  For French, we observe a similar pattern of findings. A difference lies on PC2; whereas it captures register differences, especially for child-directed speech comparing it to all other sources in English; it captures source differences in French, distinguishing book language from speech.

```{r table1}
df <- data.frame(
Lang = c("EN", "EN", "EN", "EN","EN","EN", "FR","FR","FR","FR","FR","FR"), 
Order = c("1", "2", "3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
Description = c("overall freq", "CDS", "ADS", "Media/Book", "CDS/CDB", "CDM/ADM",
 "overall freq","Book/Speech","CDS/ADS", "Media/Speech","CDM/ADM","CDB/ADB"),
Highest = c("play dough", "don't", "don't", "camera", "grrr", "beans", "doigt de pied", "sombre", "élephant", "parce que", "grand-mère ", "carottes" ),
Lowest = c("the", "tissue", "gotta", "was", "mommy", "don't", "le", "ça", "lequel", "salut", "madeleine", "grand-mère")
) 

papaja::apa_table(df, caption="Descriptions of English and French PCs")

```

<!-- standard deviation (Std Dev) and proportion of variance explained, both individually (Prop Var) and cumulatively (Cum Prop Var) by the principal components (PC1-PC6) for each language. 
PC1 already explains the bulk of the variance (`r round(pc_imp_en[2,1],3)*100`% for English and `r round(pc_imp_fr[2,1],3)*100`% for French); and PC2-PC4 each only capture an additional 2-4% of the variance for English, and 5-8% for French.  -->
<!-- In total, the first four components captured >`r round(var4en,2)*100`% of the variance for English, and >`r round(var4fr,2)*100`% for French. -->

<!-- mostly captures books for children and adults. 
This component captures that some words are very frequent in text in general, such as 'sombre' ('dark'), 'lune' ('moon') or 'autrement' ('otherwise') in comparison to the other registers. 
-->
<!--For English, PC3 (`r round(pc_imp_en[2,3],3)*100`% of variance) captures adult-directed speech, differentiating it from the other registers. It captures words such as 'mower', 'downtown' or 'vitamins', frequent in discussions between adults. -->
<!--Importantly, frequency particularities in ChS come third in order in French, compared to second in English. On the contrary, word frequency in books differs from all other registers in French, and comes second in order.-->


```{r pca-table, include=F}
row.names(pc_imp_en) = c("EN StdDev","EN PropVar","EN CumPropVar")
row.names(pc_imp_fr) = c("FR StdDev","FR PropVar","FR CumPropVar")

table_1<-rbind(pc_imp_en, pc_imp_fr)

table_1 %>%
    papaja::apa_table(digits=2, caption="Importance of components from PCA for English (above) and French (below).", placement='h')
```

```{r pca-en-table, include=T}
require(kableExtra)
#pc_bsa$rotation  * -1
ddbsa <- cbind(dddc, data.frame(pc_bsa$x))


en_rot <- rbind(pc_bsa$rotation, pc_imp_en[2,]) 
row.names(en_rot)[7] = "PVar"
#en_rot %>%
#  kbl(caption = "English principal component rotations.", digits=2, booktabs=T) %>%
#  column_spec(2, italic=c(T,T,T,T,T,T,F)) %>% # PC1
#  column_spec(3, bold=c(F,F,T,F,F,F,F), italic=c(F,F,F,F,T,F,F)) %>% # PC2
#  column_spec(4, bold=c(F,F,F,F,F,T,F), italic=c(T,F,F,F,F,F,F)) %>%
#  column_spec(5, bold=c(F,F,F,T,F,F,F), italic=c(F,T,F,F,F,F,F)) %>%
#  column_spec(6, bold=c(F,T,F,F,F,F,F), italic=c(F,F,T,F,F,F,F)) %>%
#  column_spec(7, bold=c(T,F,F,F,F,F,F), italic=c(F,F,F,T,F,F,F)) %>%
#  kable_styling(latex_options = "striped", stripe_index = 7)

en_rot %>%
  kbl(caption = "English principal component rotations.", digits=2, booktabs=T) %>%
  column_spec(2, italic=c(T,T,T,T,T,T,F), color="white", background=spec_color(en_rot[,1], option="A", end=.8)) %>% # PC1
  column_spec(3, bold=c(F,F,T,F,T,F,F), color="white", background=spec_color(en_rot[,2], option="A", end=.8)) %>% # PC2
  column_spec(4, bold=c(T,F,F,F,F,T,F), color="white", background=spec_color(en_rot[,3], option="A", end=.8)) %>%
  column_spec(5, bold=c(F,F,F,T,F,F,F), color="white", background=spec_color(en_rot[,4], option="A", end=.8)) %>%
  column_spec(6, bold=c(F,T,T,F,F,F,F), color="white", background=spec_color(en_rot[,5], option="A", end=.8)) %>%
  column_spec(7, bold=c(T,F,F,T,F,F,F), color="white", background=spec_color(en_rot[,6], option="A", end=.8)) %>%
  column_spec(1, color="black", background = "white") %>%
  row_spec(7, color="black", background = "white")
  #kable_styling(latex_options = "striped", stripe_index = 7)
```

```{r pca-fr-table, include=T}
#pc_bsa$rotation  * -1
#pc_bsa_fr$rotation = pc_bsa_fr$rotation  * -1
#pc_bsa_fr$rotation[,1] = pc_bsa_fr$rotation[,1]  * -1

#pc_bsa_fr$x = pc_bsa_fr$x  * -1
#pc_bsa_fr$x[,1] = pc_bsa_fr$x[,1]  * -1

ddbsa_fr <- cbind(dddc_fr, data.frame(pc_bsa_fr$x))

fr_rot <- rbind(pc_bsa_fr$rotation, pc_imp_fr[2,]) 
row.names(fr_rot)[7] = "PVar"
fr_rot %>%
  kbl(caption = "French principal component rotations.", digits=2, booktabs=T) %>%
  column_spec(2, italic=c(T,T,T,T,T,T,F), color="white", background=spec_color(fr_rot[,1], option="A", end=.8)) %>% # PC1
  column_spec(3, bold=c(F,T,T,F,T,F,F), color="white", background=spec_color(fr_rot[,2], option="A", end=.8)) %>% # PC2
  column_spec(4, bold=c(F,F,T,F,F,T,F), color="white", background=spec_color(fr_rot[,3], option="A", end=.8)) %>%
  column_spec(5, bold=c(T,F,F,F,F,T,F), color="white", background=spec_color(fr_rot[,4], option="A", end=.8)) %>%
  column_spec(6, bold=c(T,F,F,T,F,F,F), color="white", background=spec_color(fr_rot[,5], option="A", end=.8)) %>%
  column_spec(7, bold=c(F,T,F,F,T,F,F), color="white", background=spec_color(fr_rot[,6], option="A", end=.8)) %>%
  column_spec(1, color="black", background = "white") %>%
  row_spec(7, color="black", background = "white")
  #kable_styling(latex_options = "striped", stripe_index = 7)
```



## PCA-based Age of Acquisition Regression (Q2)


Next, we turned to our second question: how well different frequency distributions predict English- and French-learning children's early word learning. 
Our approach was to fit a linear regression model predicting each CDI word's mean AoA, following previous work [@braginsky2019consistency; @goodman2008].


Multicollinearity makes it unwise to include multiple raw frequency distributions in a regression, however, as the results will be unstable. We verified that this situation was the case by running a regression predicting AoA with the logarithm of word frequency from each of the six distributions as a predictor. The Variance Inflation Factor (VIF) estimates the inflation of the variance of a regression coefficient when there is correlation between predictors [@dodge2008concise]. The higher the VIF for a predictor, the less reliable the regression results are when that predictor is included. 
The VIF for every distribution was $>>1$ (and many $>5$), indicating that these variables show strong multicollinearity which may compromise the reliability of the regression results. 
We thus used the CDI items' PCA loadings in lieu of the frequency distributions to predict AoA. 

<!-- Figures showing the loadings of CDI items on PC1-PC4 by lexical class vs. the average age of acquisition (AoA; in months) can be found on [OSF](https://osf.io/46gj2/?view_only=2db5950a96a44f289b6e778e60391662). -->

```{r}
ddbsa <- ddbsa %>%
  mutate(LC = case_when(lexical_class=="nouns" ~ "noun",
                        lexical_class=="verbs" ~ "verb",
                        lexical_class=="adjectives" ~ "adj",
                        lexical_class=="function_words" ~ "func",
                        lexical_class=="other" ~ "other",
                        TRUE ~ as.character(lexical_class)))

ddbsa_fr <- ddbsa_fr %>%
  mutate(LC = case_when(lexical_class=="nouns" ~ "noun",
                        lexical_class=="verbs" ~ "verb",
                        lexical_class=="adjectives" ~ "adj",
                        lexical_class=="function_words" ~ "func",
                        lexical_class=="other" ~ "other",
                        TRUE ~ as.character(lexical_class)))

```


```{r raw-logfreq-aoa-regression, include=F, results='asis'}
lm1 <- lm(aoa ~ log(ChS) + log(ChM) + log(ChB) + log(AdS) + log(AdM) + log(AdB) + Nletters, data=dddc)
# R^2 = 0.3433
tab <- data.frame(summary(lm1)$coefficients)
tab$VIF = c(NA, car::vif(lm1))
names(tab) = c("Beta","SE","t-val","p-val","VIF")
#tab %>% kable(digits=2)
print(xtable(tab, digits=2,
             caption = "Coefficients for English corpora frequencies predicting AoA.",
             table.placement = "H"), comment=F)

lm1_fr <- lm(aoa ~ log(ChS) + log(ChM) + log(ChB) + log(AdS) + log(AdM) + log(AdB) + Nletters, data=dddc_fr)
# R^2 = .06
tab_fr <- data.frame(summary(lm1_fr)$coefficients)
tab_fr$VIF = c(NA, car::vif(lm1_fr))
names(tab_fr) = c("Beta","SE","t-val","p-val","VIF")
print(xtable(tab_fr, digits=2,
             caption = "Coefficients for French corpora frequencies predicting AoA.",
             table.placement = "H"), comment=F)

```




```{r, include=F}
## Correlation of PCA with original Frequency Distributions
cor(ddbsa[,c("ChM","ChB","ChS","AdM","AdB","AdS")], ddbsa[,paste0("PC",1:6)]) %>%
  papaja::apa_table(digits=2, caption="Correlation of PC loadings with frequency distributions.", placement='h')
```


```{r, include=F}
## Correlation of PCs with AoA
aoa_pc_en <- ddbsa %>% 
  group_by(LC) %>%
  summarise(PC1 = cor(aoa, PC1), PC2 = cor(aoa, PC2), PC3 = cor(aoa, PC3),
            PC4 = cor(aoa, PC4), PC5 = cor(aoa, PC5), PC6 = cor(aoa, PC6))

aoa_pc_en <- as.data.frame(aoa_pc_en)
sc = c(min(unlist(aoa_pc_en[,2:7])), max(unlist(aoa_pc_en[,2:7])))
aoa_pc_en %>%
  kbl(caption = "Correlation of English AoA with PC loadings by LC.", digits=2, booktabs=T) %>%
  column_spec(2, color="white", background=spec_color(aoa_pc_en[,2], option="A", end=.8, scale_from=sc)) %>% # PC1
  column_spec(3, color="white", background=spec_color(aoa_pc_en[,3], option="A", end=.8, scale_from=sc)) %>% # PC2
  column_spec(4, color="white", background=spec_color(aoa_pc_en[,4], option="A", end=.8, scale_from=sc)) %>%
  column_spec(5, color="white", background=spec_color(aoa_pc_en[,5], option="A", end=.8, scale_from=sc)) %>%
  column_spec(6, color="white", background=spec_color(aoa_pc_en[,6], option="A", end=.8, scale_from=sc)) %>%
  column_spec(7, color="white", background=spec_color(aoa_pc_en[,7], option="A", end=.8, scale_from=sc)) %>%
  column_spec(1, color="black", background = "white") 
```


```{r, include=F}
aoa_pc_fr <- ddbsa_fr %>% filter(aoa<40, !is.na(aoa)) %>%
  group_by(LC) %>%
  summarise(PC1 = cor(aoa, PC1), PC2 = cor(aoa, PC2), PC3 = cor(aoa, PC3),
            PC4 = cor(aoa, PC4), PC5 = cor(aoa, PC5), PC6 = cor(aoa, PC6)) 

aoa_pc_fr <- as.data.frame(aoa_pc_fr)
sc = c(-.4,.4) #c(min(unlist(aoa_pc_fr[,2:7])), max(unlist(aoa_pc_fr[,2:7])))
aoa_pc_fr %>%
  kbl(caption = "Correlation of French AoA with PC loadings by LC.", digits=2, booktabs=T) %>%
  column_spec(2, color="white", background=spec_color(aoa_pc_fr[,2], option="A", end=.8)) %>% # PC1
  column_spec(3, color="white", background=spec_color(aoa_pc_fr[,3], option="A", end=.8)) %>% # PC2
  column_spec(4, color="white", background=spec_color(aoa_pc_fr[,4], option="A", end=.8)) %>%
  column_spec(5, color="white", background=spec_color(aoa_pc_fr[,5], option="A", end=.8)) %>%
  column_spec(6, color="white", background=spec_color(aoa_pc_fr[,6], option="A", end=.8)) %>%
  column_spec(7, color="white", background=spec_color(aoa_pc_fr[,7], option="A", end=.8)) %>%
  column_spec(1, color="black", background = "white") 
```


```{r, include=F}
## Mean PC values by LC
m_pc_en <- ddbsa %>% 
  group_by(LC) %>%
  summarise(PC1 = mean(PC1), PC2 = mean(PC2), PC3 = mean(PC3), 
            PC4 = mean(PC4), PC5 = mean(PC5), PC6 = mean(PC6))

m_pc_en <- as.data.frame(m_pc_en)
m_pc_en %>%
  kbl(caption = "Mean PC values of English words by lexical class.", digits=2, booktabs=T) %>%
  column_spec(2, color="white", background=spec_color(m_pc_en[,2], option="A", end=.8)) %>% # PC1
  column_spec(3, color="white", background=spec_color(m_pc_en[,3], option="A", end=.8)) %>% # PC2
  column_spec(4, color="white", background=spec_color(m_pc_en[,4], option="A", end=.8)) %>%
  column_spec(5, color="white", background=spec_color(m_pc_en[,5], option="A", end=.8)) %>%
  column_spec(6, color="white", background=spec_color(m_pc_en[,6], option="A", end=.8)) %>%
  column_spec(7, color="white", background=spec_color(m_pc_en[,7], option="A", end=.8)) %>%
  column_spec(1, color="black", background = "white") 
```


```{r, include=F}
## Mean PC values by LC
m_pc_fr <- ddbsa_fr %>% 
  group_by(LC) %>%
  summarise(PC1 = mean(PC1), PC2 = mean(PC2), PC3 = mean(PC3), 
            PC4 = mean(PC4), PC5 = mean(PC5), PC6 = mean(PC6))

m_pc_fr <- as.data.frame(m_pc_fr)
m_pc_fr %>%
  kbl(caption = "Mean PC values of French words by lexical class.", digits=2, booktabs=T) %>%
  column_spec(2, color="white", background=spec_color(m_pc_fr[,2], option="A", end=.8)) %>% # PC1
  column_spec(3, color="white", background=spec_color(m_pc_fr[,3], option="A", end=.8)) %>% # PC2
  column_spec(4, color="white", background=spec_color(m_pc_fr[,4], option="A", end=.8)) %>%
  column_spec(5, color="white", background=spec_color(m_pc_fr[,5], option="A", end=.8)) %>%
  column_spec(6, color="white", background=spec_color(m_pc_fr[,6], option="A", end=.8)) %>%
  column_spec(7, color="white", background=spec_color(m_pc_fr[,7], option="A", end=.8)) %>%
  column_spec(1, color="black", background = "white") 
```

Given that past research has found that lexical class strongly modulates influences of word frequency, we next examined the interaction of lexical class (LC) with PC1 - PC6 in our regression. We also included the number of letters as a predictor (Nletters) to help control for the overall difficulty of each word. To determine if the inclusion of all PCs was justified, we ran a series of ANOVAs building up from PC1 to PC6--in decreasing order of the variance they accounted for in the PCA[^p]. 
For English, the more complex model was always significantly preferred, including up to the inclusion of PC6 ($R^2 = .58$). The same was observed for French, indicating that registers and sources both matter for early word learning. However, the french model explained less variation of the dependent value overall ($R^2 = .09$). Figure 2 shows the coefficient estimates with p<0.05 for both languages.

[^p]:The R syntax for the sequence of regressions was `AoA`$\sim$`PC1*LC`, `AoA`$\sim$`(PC1+PC2)*LC`, ..., `AoA`$\sim$`(PC1+PC2+PC3+PC4+PC5+PC6)*LC`, with noun as the baseline LC.


For English, PC1, PC2, PC3, PC4 and PC5 predict the age of acquisition. 
Overall frequency (PC1) is a predictor; words which are frequent in general are learned earlier than less frequent words. 
Child-directed speech (PC2) is a predictor; words which are frequent in this register are learned earlier on. 
On the contrary, in the adult-directed speech predictor (PC3), frequent words are learned later on. 
Word frequency in media distinguished from words in books is a predictor (PC4); words which are frequent in media as distinguished by words in books, are learned earlier on.
Word frequency in child-directed speech as distinguished from words in child-directed books is also a predictor, with earlier acquisition predicted for more speechy/less booky words. We also observe that overall frequency (PC1) interacts with lexical class, verbs, function words and adjectives being learned later than nouns. 
PC2 interacts with verbs, which are learned later than nouns. 
PC3 and PC6 each interacted with function words, which are learned later than nouns.

For French, PC1 and PC2 predict the age of acquisition. Words which are frequent in general are learned earlier than less frequent words, and both books and speech are important. PC4 interacts with adjectives, PC5 with function words and PC6 with other. 
In both languages, there is no significant effect of word length. 

To sum up, in both languages, we observe that the predictive value of word frequency comes from both speech and books. However, for English, the difference across registers (difficulty of adult-directed versus child-directed) is emphasized. For French, the difference and difficulty of text, independent of register, is emphasized.



```{r, fig.env = "figure", fig.pos = "H", fig.align='center', fig.width=3.3, fig.height=5.0, set.cap.width=T, num.cols.cap=1, fig.cap = "Regression coefficients for predicting CDI AoAs with PCs and lexical class for English (top) and French (bottom)."}
# could try adding in PCs one by one..

ddbsa$LC <- fct_relevel(ddbsa$LC, "noun")
pca_lc1 <- lm(aoa ~ PC1 * LC, data=ddbsa) # R^2=.26
pca_lc2 <- lm(aoa ~ (PC1 + PC2) * LC, data=ddbsa) # R^2=.47
pca_lc3 <- lm(aoa ~ (PC1 + PC2 + PC3) * LC, data=ddbsa)
pca_lc4 <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4) * LC, data=ddbsa)
pca_lc5 <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4 + PC5) * LC, data=ddbsa) # 0.576
pca_lc6 <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4 + PC5 + PC6) * LC, data=ddbsa)
English <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4 + PC5 + PC6) * LC, data=ddbsa)
ttt <- anova(pca_lc1, pca_lc2) # 2***
ttt <- rbind(ttt, anova(pca_lc2, pca_lc3)[2,]) # 3***
ttt <- rbind(ttt, anova(pca_lc3, pca_lc4)[2,]) # 4***
ttt <- rbind(ttt, anova(pca_lc4, pca_lc5)[2,]) # 5***
ttt <- rbind(ttt, anova(pca_lc5, pca_lc6)[2,]) # 6*
#summary(pca_lc6) # R^2 = .584
#summary(pca_lc4) # R^2 = .538
pca_tab2 <- data.frame(summary(pca_lc4)$coefficients)
#car::vif(pca_lc_reg)
names(pca_tab2) = c("Beta","SE","t-val","p-val")
#print(xtable(pca_tab2, digits=2,
#             caption = "Regression predicting English CDI AoAs with PCs and lexical class.",
#             table.placement = "H"), comment=F)

ddbsa_fr$LC <- fct_relevel(ddbsa_fr$LC, "noun")
pca_lc1_fr <- lm(aoa ~ PC1 * LC, data=ddbsa_fr) 
pca_lc2_fr <- lm(aoa ~ (PC1 + PC2) * LC, data=ddbsa_fr) 
pca_lc3_fr <- lm(aoa ~ (PC1 + PC2 + PC3) * LC, data=ddbsa_fr)
pca_lc4_fr <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4) * LC, data=ddbsa_fr)
pca_lc5_fr <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4 + PC5) * LC, data=ddbsa_fr) 
pca_lc6_fr <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4 + PC5 + PC6  + Nletters) * LC, data=ddbsa_fr)
French <- lm(aoa ~ (PC1 + PC2 + PC3 + PC4 + PC5 + PC6  + Nletters) * LC, data=ddbsa_fr)

ttt_fr <- anova(pca_lc1_fr, pca_lc2_fr) # 2***
ttt_fr <- rbind(ttt_fr, anova(pca_lc2_fr, pca_lc3_fr)[2,]) # not better! PC1 + PC2 only
ttt_fr <- rbind(ttt_fr, anova(pca_lc3_fr, pca_lc4_fr)[2,]) # marginal
ttt_fr <- rbind(ttt_fr, anova(pca_lc4_fr, pca_lc5_fr)[2,]) # marginal
ttt_fr <- rbind(ttt_fr, anova(pca_lc5_fr, pca_lc6_fr)[2,]) # better
#summary(pca_lc6_fr) 
#summary(pca_lc4_fr) 

en_coef_list = c("PC1","PC2","PC3","PC4","PC5", "LCadj", "LCfunc", "LCother", 
              "LCverb", "PC1:LCadj", "PC1:LCfunc", "PC1:LCother", "PC1:LCverb", 
              "PC2:LCother", "PC2:LCverb", "PC3:LCfunc", "PC6:LCfunc", "Nletters:LCfunc")

#fr_coef_list = c("PC1","PC2","PC3","PC4","LCadj","LCverb","PC1:LCadj","PC1:LCfunc","PC1:LCother")
fr_coef_list = c("PC1","PC2","PC4:LCadj","PC5:LCfunc","PC6:LCother")

e<-coefplot(pca_lc6, coefficients = en_coef_list, vertical=TRUE, 
              mar=c(5.5,2.5,2,2), col.pts="red", cex=.8, xlab='') + 
  theme_bw() + theme(plot.title = element_text(size=10))
f<-coefplot(pca_lc2_fr, add=TRUE, col.pts="blue", coefficients = fr_coef_list, vertical=TRUE, 
              mar=c(5.5,2.5,2,2), cex=.8, xlab='', offset=.2) + 
  theme_bw() + theme(plot.title = element_text(size=10))

#multiplot(English, French, coefficients = en_coef_list, cex=.8, xlab='', decreasing=TRUE)+
#  theme_bw() + 
#  theme(plot.title = element_text(size=10 ))+ theme(legend.position='bottom')

ggarrange(e,f, ncol=1, legend = "none", heights=c(2,1))
```


## Principal components and maternal education (Q3)

Previous findings relate SES status to book reading [@shen2022parent], which is in turn related to better language skills [@bus1995joint]. 
These findings suggest that the vocabulary composition of children from higher-SES households may be better predicted by the word frequencies seen in child-directed books, rather than those from child-directed speech. To test this idea, we did an exploratory logistic regression using the first four PCs to predict the number of children in Wordbank who produce or don't produce each item, along with interactions of mother's education and children's age. Due to lack of maternal education data for French data, we focus on American English-learning children. American English data from Wordbank contained 2,776 CDI:WS administrations with mother's education coded as a factor (baseline (0): no more than secondary education (N=547), 1 for some/all college (N=1483), and 2 for at least some graduate school (N=746)).
<!--The R syntax for the formula is `cbind(total_producing, total_not_producing) ~ age * mother_ed * (PC1 + PC2 + PC3 + PC4)`.-->

There were significant main effects of age, mother's education, and PC1-PC4 (all $p<.001$).
There were significant interactions of age with mother's education ($p<.001$), PC2 ($p<.001$), and PC4 ($p=.009$).
There were significant interactions of mother's education with PC1-PC3 (all $p<.001$), shown in Figure 3.



```{r en-momed-regression, include=T, results='asis'}
load(here("data/en_ws.Rdata"))

en_mom_ed = table(en_demo$mom_ed)
# None = 0, Primary = 8, Some Secondary = 123

en_dat <- en_long_ws %>% left_join(en_demo) %>%
  filter(!is.na(mom_ed)) %>%
  mutate(mom_ed_num = case_when(as.numeric(mom_ed)<5 ~ -1, # secondary or less
                                as.numeric(mom_ed)<7 ~ 0, # some college / college
                                TRUE ~ 1)) %>%  # some graduate / graduate
  mutate(MotherEd = case_when(as.numeric(mom_ed)<5 ~ "Secondary", # secondary or less
                                as.numeric(mom_ed)<7 ~ "College", # some college / college
                                TRUE ~ "Graduate")) %>%
  group_by(age, MotherEd, definition) %>%
  summarise(total_prod = sum(produces, na.omit=T), 
            total_not_prod = sum(produces==0, na.omit=T))

en_dat <- en_dat %>% left_join(ddbsa %>% select(definition, Nletters, PC1, PC2, PC3, PC4, PC5, PC6)) %>%
  mutate(age_sc = scale(age, center=T, scale=F)) %>% 
  filter(!is.na(PC1)) # get rid of the 10 CDI phrases we don't match (give me five!, pet's name etc.)
# unique(en_dat[is.na(en_dat$PC1),]$definition)

# scale/center the PC vars?

en_dat$MotherEd = factor(en_dat$MotherEd, levels=c("Secondary","College","Graduate"))

# whenever we center age (age_sc), matrix is rank deficient and age_sc main effect doesn't appear... 
en2 <- glmer(cbind(total_prod, total_not_prod) ~ age * MotherEd * (PC1 + PC2) + (1|definition), family = binomial(logit), nAGQ=0, data=en_dat) 
# PC1 +.03, PC2 +.19, mom_ed +.06, PC1:mom_ed +.003, PC2:mom_Ed +.008

en3 <- glmer(cbind(total_prod, total_not_prod) ~ age * MotherEd * (PC1 + PC2 + PC3) + (1|definition), family = binomial(logit), nAGQ=0, data=en_dat)
# PC1 +.03, PC2 +.19, PC3 -.19

en4 <- glmer(cbind(total_prod, total_not_prod) ~ age * MotherEd * (PC1 + PC2 + PC3 + PC4) + (1|definition), family = binomial(logit), nAGQ=0, data=en_dat)


#anova(en2, en3)
#anova(en3, en4)

#summary(en2)
#summary(en3)
mom_ed_tab <- summary(en4)$coefficients

colnames(mom_ed_tab) = c("Beta","SE","t-val","p-val")

print(xtable(mom_ed_tab[1:14,], digits=2,
             caption = "Regression coefficients for predicting English CDI items using PCs and mother's education.",
             table.placement = "H"), comment=F)
```



```{r, fig.env = "figure", fig.pos = "H", fig.align='center', fig.width=3.5, fig.height=3.9, set.cap.width=T, num.cols.cap=1, fig.cap = "Predicted effects of maternal education and PC1-PC4 on the probability of children producing CDI words."}
# ggpredict returns conditional effects, while ggeffect/ggemmeans return marginal means
# (i.e. averaged over the levels of factors)

#ggeffect(en4, c("age", "PC1", "MotherEd")) %>% plot()
#pred <- ggpredict(en4)

# age, PC, MomEd
#pc1a <- ggpredict(en4, c("age", "MotherEd", "PC1")) %>% plot() + 
#  ylab("Probability of Production") + ggtitle("")

ylab_momed = "Prob. of Production"

# ToDo: titles with PC descriptions?
pc1 <- ggpredict(en4, c("PC1", "MotherEd")) %>% plot() + # consider using "PC1 [all]" ?
  ylab(ylab_momed) + ggtitle("") + theme_classic(base_size=10) + 
  theme(plot.title = element_blank())

pc2 <- ggpredict(en4, c("PC2", "MotherEd")) %>% plot() + 
  ylab(ylab_momed) + ggtitle("") + theme_classic(base_size=10) +
  theme(plot.title = element_blank())

pc3 <- ggpredict(en4, c("PC3", "MotherEd")) %>% plot() + 
  ylab(ylab_momed) + ggtitle("") + theme_classic(base_size=10) + 
  theme(plot.title = element_blank())

pc4 <- ggpredict(en4, c("PC4", "MotherEd")) %>% plot() + 
  ylab(ylab_momed) + ggtitle("") + theme_classic(base_size=10) + 
  theme(plot.title = element_blank())

ggarrange(pc1, pc2, pc3, pc4, nrow=2, ncol=2, common.legend = T)
```



# Discussion
We set out to investigate the sources of linguistic input and registers that children may experience, using word frequency distributions garnered from child-directed and adult-directed corpora of speech, books, and media (TV and movies). We found the principal components (PCs) of these distributions, and described how these PCs capture variation both in adult- vs. child-directedness, as well as between modalities (e.g., books and speech). 


Our findings show that PC1 explains 95% of the variance in frequency distributions. This means that most frequency is shared by the different sources, thus accounted for by that one component. Moreover, multiple components are predictive of children's age of acquisition of words from the CDI. Speech, but also books and media are all relevant in predicting age of acquisition, as well as child-directed speech. This suggests that children's environmental exposure to different language sources, even when these include books or even media, could impact their word learning trajectory.
It is somewhat surprising that even sources of input that young children rarely encounter (e.g., adult-directed books) contribute significantly to predicting variation in children's early word learning.

We also used English Wordbank data to examine how well the frequency components combine with mother's education--a measure of SES that has been found in the past to be positively related to early word learning, and to more child-directed reading--to predict children's early word learning. This analysis revealed significant contributions of multiple PCs, as well as the interaction of mother's education with PC1 (overall frequency), PC2 (child-directed speech), and PC3 (adult-directed speech), but not of the child-directed books component (PC4).

These findings are important for educational reasons and could inform future interventions on the importance of including language from different sources. A target for future research is to predict individual children's learning of particular words using these principal components, in combination with parent-reported measures of how much time their child spends daily receiving input from each of the input sources ([adult- vs. child-directed] x [books, media, and speech]).

Finally, there was overwhelming similarity of word frequency distributions from different sources and their predictive value in English and French data, which supports the robustness of the results. At the same time,  these distributions show systematic variation--at least in English and in French, which can predict some of the variation in children's early word learning. We should also notice that different data and corpus sizes were used to represent the sources for each language. Differences could also be partly attributed to this e.g., the French corpora were composed of several smaller ones, due to the lack of large accessible corpora, and had slightly different use e.g. small stories in French, large books in English.

By better understanding the similarity and differences between word frequencies children experience in different contexts, future research in this vein holds the promise to predict individual differences in children's early word learning on the basis of their daily routines.


# Acknowledgements

[Redacted for anonymous review.]
<!--This research was funded in part by (Georgia's grant).
We thank members of the Language and Cognition lab for their feedback.-->


# References 

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent
